# **Bioinformatics Final Project - Species identification Pipeline**

This Git-hub repository contains scripts, data and outputs used to reconstruct, translate, align, and phylogenetically analyse unknown meat samples using DNA barcoding. The project aims to identify the species of origin of samples intercepted at Heathrow Airport.
*intermediate files are not included and WILL need to be generated by the user through the workflow below
---

## **Repository Structure**

finalproject/
|
|-- merged_sequences/                                                    # Aligned homolog/outgroup sets and Cleaned & merged FASTA outputs (following generation)
| |-- A_homologous_seqs
| |-- B_homologous_seqs
| |-- C_homologous_seqs
| |-- D_homologous_seqs
| |-- outgroup_seq
|
|-- results/                                                             # Final analysis outputs
| |-- MSA.aln-fasta
| |-- phylogenetic_tree_wDp3
| |-- phylogenetic_tree_woDp3
| |-- translated_sequences.fasta
|
| |-- samples/                                                           # Original sample files and conversion script
| |-- sampleA_part1
| |-- sampleA_part2
| |-- sampleA_part3
| |-- sampleB_part1
| |-- sampleB_part2
| |-- sampleB_part3
| |-- sampleC_part1
| |-- sampleC_part2
| |-- sampleC_part3
| |-- sampleD_part1
| |-- sampleD_part2
| |-- sampleD_part3
| |-- format_sequences.sh                                                # Shell script for FASTQ cleaning and conversion
|
|-- separate_sequences/                                                  # fragmented FASTA files (following generation)
|-- phylogeny_cleaner.sh                                                 # Script for final FASTA formatting before MSA
|-- translate_sequences.py                                               # Python script for ORF translation
|-- README.md

---

## **1. Pipeline Overview**

This project utilises a complete species identification workflow, including:
- Cleaning and standardising raw FASTQ files  
- Concatenating fragmented reads from each sample  
- Converting FASTQ to FASTA with quality filtering  
- Retrieving reference homologs using BLAST
- Translating nucleotide sequences into amino acids  
- Producing multiple sequence alignments (MSA)  
- Preparing data for phylogenetic inference  

---

## **2. Requirements**

### **Installed Software**
- bash (Linux / WSL)
- seqtk  
- awk, sed 
- Python 3  
- Biopython  

Install Python dependencies:
bash
Copy code
pip install biopython

Install seqtk (Ubuntu/WSL):
bash
Copy code
sudo apt-get install seqtk

External Tools (not included in repo)
MUSCLE-v5
IQ-TREE
Figtree
Aliview


3. Script Descriptions

samples/format_sequences.sh
This script should be run first in the workflow.

A shell script that:
- Removes duplicate lines and empty FASTQ entries
- Normalises header formatting
- Combines all FASTQ parts per sample
- Converts FASTQ to FASTA using seqtk (Q < 20 to N)

Outputs:
- merged_sequences/Merged_sampleX.fasta
- separate_sequences/sampleX.fasta


translate_sequences.py
Used after reference-homolog retrieval and merging.

A Python script that:
- Finds the longest open reading frame (ORF)
- Translates nucleotide sequences into amino acids using vertebrate mitochondrial code
- Outputs translated_sequences.fasta for alignment

phylogeny_cleaner.sh
Used before MSA. 

It:
- Formats headers to species names
- Removes unknown amino acids
- Ensures FASTA formatting is compatible with IQ-TREE and other phylogeny tools

4. Example Workflow
Step 1: Run the FASTQ cleaning + conversion pipeline
Start inside the samples directory:

cd samples
bash
Copy code
./format_sequences.sh

Step 2: Retrieve homologous sequences (manual step)
Perform BLASTn for each merged sample and save aligned reference sequences into merged_sequences/

Step 3: Translate sequences
From the main project directory:

bash 
Copy code
python3 ./translate_sequences.py

Step 4: Prepare FASTA for phylogeny

bash
Copy code
bash phylogeny_cleaner.sh

Step 5: Align sequences externally

Step 6: Build the phylogenetic tree

5. Output Summary

- Merged FASTA Sequences: High-quality nucleotide sequences for BLAST and translation.
- Separate FASTA Sequences: Fragmented sequences by parts for contamination checks.
- translated_sequences.fasta: Protein sequences used for MSA.
- MSA.aln-fasta: Multiple sequence alignment of unknown samples and homologs and outgroup.
- Phylogenetic Trees: These trees support species identification and highlight contamination issues.
- One including contaminated Sample D part 3 (wDp3)
- One excluding it (woDp3)

7. Contact

For issues, questions, or reproducibility assistance:
Email: milehamhenry@yahoo.com
GitHub: Henerz23